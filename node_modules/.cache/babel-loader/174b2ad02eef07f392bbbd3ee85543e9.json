{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/aleksandrnistratov/Desktop/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/aleksandrnistratov/Desktop/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'../index.css';import Header from'./Header';import Main from'./Main';import Footer from'./Footer';import PopupWithForm from'./PopupWithForm';import ImagePopup from'./ImagePopup';import EditProfilePopup from'./EditProfilePopup';import EditAvatarPopup from'./EditAvatarPopup';import React from'react';import{api}from'../utils/Api';import{CurrentUserContext}from'../contexts/CurrentUserContext';import AddPlacePopup from'./AddPlacePopup';function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditAvatarPopupOpen=_React$useState2[0],setEditAvatarPopupOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditProfilePopupOpen=_React$useState4[0],setEditProfilePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isAddPlacePopupOpen=_React$useState6[0],setAddPlacePopupOpen=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),selectedCard=_React$useState8[0],setSelectedCard=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),currentUser=_React$useState10[0],setCurrentUser=_React$useState10[1];React.useEffect(function(){api.getUserInfo().then(function(res){setCurrentUser(res);}).catch(function(err){return alert(err);});},[]);function handleEditAvatarClick(){setEditAvatarPopupOpen(true);}function handleEditProfileClick(){setEditProfilePopupOpen(true);}function handleAddPlaceClick(){setAddPlacePopupOpen(true);}function handleCardClick(data){setSelectedCard(data);}function closeAllPopups(){setEditAvatarPopupOpen(false);setEditProfilePopupOpen(false);setAddPlacePopupOpen(false);setSelectedCard(null);}//Изменение инфо\nfunction handleUpdateUser(data){api.addUserInfo(data).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return alert(err);});}// Изменение аватара\nfunction handleUpdateAvatar(data){api.addUserAvatar(data).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return alert(err);});}//Отрисовка карточек с сервера\nvar _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),cards=_React$useState12[0],setCards=_React$useState12[1];React.useEffect(function(){api.getAllCards().then(function(data){setCards(data);}).catch(function(err){return alert(err);});},[]);// Лайк\nfunction handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});isLiked?//Отправляем запрос для удаления лайка\napi.dislikeCard(card._id).then(function(res){var dislikeCard=cards.map(function(item){return item._id===card._id?res:item;});setCards(dislikeCard);}).catch(function(err){return alert(err);}):// Отправляем запрос в API и получаем обновлённые данные карточки\napi.likeCard(card._id,!isLiked).then(function(newCard){// Формируем новый массив на основе имеющегося, подставляя в него новую карточку\nvar newCards=cards.map(function(c){return c._id===card._id?newCard:c;});// Обновляем стейт\nsetCards(newCards);}).catch(function(err){return alert(err);});};// Удаление карточки\nfunction handleCardDelete(card){// Определяем, являемся ли мы владельцем текущей карточки\nvar isOwn=card.owner._id===currentUser._id;if(isOwn){api.deleteCards(card._id).then(function(){var filterCard=cards.filter(function(item){return item._id!==card._id;});setCards(filterCard);}).catch(function(err){return alert(err);});}}//Создаем новую карточку\nfunction handleAddPlaceSubmit(data){api.addNewCards(data).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){return alert(err);});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditAvatar:handleEditAvatarClick,onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,handleCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"popup__with-submit\",container:\"popup__container-with-submit\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",submit:\"popup__submit-with-submit\",type:\"popup__title-with-submit\"}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"sources":["/Users/aleksandrnistratov/Desktop/mesto-react/src/components/App.js"],"names":["Header","Main","Footer","PopupWithForm","ImagePopup","EditProfilePopup","EditAvatarPopup","React","api","CurrentUserContext","AddPlacePopup","App","useState","isEditAvatarPopupOpen","setEditAvatarPopupOpen","isEditProfilePopupOpen","setEditProfilePopupOpen","isAddPlacePopupOpen","setAddPlacePopupOpen","selectedCard","setSelectedCard","currentUser","setCurrentUser","useEffect","getUserInfo","then","res","catch","err","alert","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","data","closeAllPopups","handleUpdateUser","addUserInfo","handleUpdateAvatar","addUserAvatar","cards","setCards","getAllCards","handleCardLike","card","isLiked","likes","some","i","_id","dislikeCard","map","item","likeCard","newCard","newCards","c","handleCardDelete","isOwn","owner","deleteCards","filterCard","filter","handleAddPlaceSubmit","addNewCards"],"mappings":"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","sourcesContent":["import '../index.css';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport PopupWithForm from './PopupWithForm';\nimport ImagePopup from './ImagePopup';\nimport EditProfilePopup from './EditProfilePopup';\nimport EditAvatarPopup from './EditAvatarPopup';\nimport React from 'react';\nimport { api } from '../utils/Api';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport AddPlacePopup from './AddPlacePopup';\n\nfunction App() {\n    const [ isEditAvatarPopupOpen, setEditAvatarPopupOpen] = React.useState(false);\n    const [ isEditProfilePopupOpen, setEditProfilePopupOpen] = React.useState(false);\n    const [ isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\n    const [ selectedCard, setSelectedCard] = React.useState(null);\n\n    const [currentUser, setCurrentUser] = React.useState('');\n\n    React.useEffect(() => {\n        api.getUserInfo()\n            .then(res => {\n                setCurrentUser(res)\n            }).catch((err) => alert(err));\n    }, [])\n\n    function handleEditAvatarClick () {\n        setEditAvatarPopupOpen(true);\n    }\n\n    function handleEditProfileClick () {\n        setEditProfilePopupOpen(true);\n    }\n\n    function handleAddPlaceClick () {\n        setAddPlacePopupOpen(true);\n    }\n\n    function handleCardClick(data) {\n        setSelectedCard(data);\n    }\n\n    function closeAllPopups() {\n        setEditAvatarPopupOpen(false);\n        setEditProfilePopupOpen(false);\n        setAddPlacePopupOpen(false);\n        setSelectedCard(null);\n    }\n    //Изменение инфо\n    function handleUpdateUser(data) {\n        api.addUserInfo(data).then((res) => {\n            setCurrentUser(res);\n            closeAllPopups();\n        }).catch((err) => alert(err));\n    }\n    // Изменение аватара\n    function handleUpdateAvatar(data) {\n        api.addUserAvatar(data).then((res) => {\n            setCurrentUser(res);\n            closeAllPopups();\n        }).catch((err) => alert(err));\n    }\n    //Отрисовка карточек с сервера\n    const [cards, setCards] = React.useState([]);\n    React.useEffect(() => {\n        api.getAllCards()\n            .then(data => {\n                setCards(data)\n            }).catch((err) => alert(err));\n    }, []);\n\n    // Лайк\n    function handleCardLike(card) {\n        // Снова проверяем, есть ли уже лайк на этой карточке\n        const isLiked = card.likes.some(i => i._id === currentUser._id);\n\n        isLiked ? (\n            //Отправляем запрос для удаления лайка\n            api.dislikeCard(card._id).then((res) => {\n                const dislikeCard = cards.map((item) => item._id === card._id ? res : item);\n                setCards(dislikeCard)\n            }).catch((err) => alert(err))\n        ) : (\n            // Отправляем запрос в API и получаем обновлённые данные карточки\n            api.likeCard(card._id, !isLiked).then((newCard) => {\n                // Формируем новый массив на основе имеющегося, подставляя в него новую карточку\n                const newCards = cards.map((c) => c._id === card._id ? newCard : c);\n                // Обновляем стейт\n                setCards(newCards);\n            }).catch((err) => alert(err))\n        )\n    };\n    // Удаление карточки\n    function  handleCardDelete(card) {\n        // Определяем, являемся ли мы владельцем текущей карточки\n        const isOwn = card.owner._id === currentUser._id;\n\n        if (isOwn) {\n            api.deleteCards(card._id).then(() => {\n                const filterCard = cards.filter((item) => item._id !== card._id)\n                setCards(filterCard);\n            }).catch((err) => alert(err));\n        }\n    }\n    //Создаем новую карточку\n    function handleAddPlaceSubmit(data) {\n        api.addNewCards(data).then((newCard) => {\n            setCards([newCard, ...cards]);\n            closeAllPopups();\n        }).catch((err) => alert(err));\n    }\n\n    return (\n        <CurrentUserContext.Provider value={currentUser}>\n            <div className=\"App\">\n                <Header />\n                <Main\n                    onEditAvatar={handleEditAvatarClick}\n                    onEditProfile={handleEditProfileClick}\n                    onAddPlace={handleAddPlaceClick}\n                    handleCardClick={handleCardClick}\n                    cards={cards}\n                    onCardLike={handleCardLike}\n                    onCardDelete={handleCardDelete}\n\n                />\n                <Footer />\n                <EditAvatarPopup\n                    isOpen={isEditAvatarPopupOpen}\n                    onClose={closeAllPopups}\n                    onUpdateAvatar={handleUpdateAvatar}\n                    />\n                <EditProfilePopup\n                    isOpen={isEditProfilePopupOpen}\n                    onClose={closeAllPopups}\n                    onUpdateUser={handleUpdateUser}\n                />\n                <AddPlacePopup\n                    isOpen={isAddPlacePopupOpen}\n                    onClose={closeAllPopups}\n                    onAddPlace={handleAddPlaceSubmit}\n                    />\n                <PopupWithForm\n                    name=\"popup__with-submit\"\n                    container=\"popup__container-with-submit\"\n                    title=\"Вы уверены?\"\n                    submit=\"popup__submit-with-submit\"\n                    type=\"popup__title-with-submit\"\n                />\n                <ImagePopup\n                    card={selectedCard}\n                    onClose={closeAllPopups}\n                />\n            </div>\n        </CurrentUserContext.Provider>\n    );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}